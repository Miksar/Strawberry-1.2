
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>Strawberry // Хитрости</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link href="_tpl/style.css" rel="stylesheet" type="text/css" media="screen">
</head>

<body>

<h1>Оглавление</h1>
<ul>
<li><a href="#Введение">Введение</a></li>
<li><a href="#Вывод новостей за определённую дату">Вывод новостей за определённую дату</a></li>
<li><a href="#Вывод новостей за неопределённый период">Вывод новостей за неопределённый период</a></li>
<li><a href="#Полезные ссылки">Полезные ссылки</a></li>
</ul>
<h1><a name="Введение"></a><small><a href="#top">[^]</a></small>&nbsp;Введение</h1>
<p>В этом документе будут перечислены некоторые хитрости. Полезные, не очень, вообще бессмысленные. Документ будет иногда пополняться хитростями, сразу мне всё не рассказать ведь всё зависит от ситуации, когда мне или кому-либо понадобилась та или иная хитрость. Как в поговорке, пока гром не грянет мужик не перекрестится.</p>
<p>Что я имею в виду под &quot;хитростями&quot;? Очень просто. Для меня &quot;хитрость&quot; это сделаное что-то стандартными, но не совсем простыми путями, без изменения основного когда. Хитростям могут помочь плагины, моды, но не хаки. Последнии предпологают ковыряние в коде, а это, считаю, непремлимо для хитростей.</p>
<h1><a name="Вывод новостей за определённую дату"></a><small><a href="#top">[^]</a></small>&nbsp;Вывод новостей за определённую дату</h1>
<p>Требуется вывести новости за определённый год.</p>
<p>В решении проблемы помогут переменные $year, $month и $day. </p>
<p>Чтобы получить список всех новостей за 2005-ый год нужно написать перед подключением show_news.php:</p>
<p class="code">$year = '2005';</p>
<p>За январь 2005-ого:</p>
<p class="code">$year = '2005';<br>
 $month = '01';</p>
<p>За 1 января 2005-ого:</p>
<p class="code">$year = '2005';<br>
 $month = '01';<br>
 $day = '01';</p>
<h1><a name="Вывод новостей за неопределённый период"></a><small><a href="#top">[^]</a></small>&nbsp;Вывод новостей за неопределённый период</h1>
<p>Требуется вывести все новости за, предположим, 11 дней.</p>
<p>На помощь нам придут плагины. Мы напишим маленький &quot;как бы&quot; плагин:</p>
<p class="code">add_filter('news-where', 'show_FromTo');<br>
 <br>
 function show_FromTo($where){<br>
 global $show_from, $show_to;<br>
 <br>
 if ($show_from){<br>
 $where[] = 'date < '.$show_from;<br>
 $where[] = 'and';<br>
 }<br>
 <br>
 if ($show_to){<br>
 $where[] = 'date > '.$show_to;<br>
 $where[] = 'and';<br>
 }<br>
 <br>
 return $where;<br>
 }</p>
<p>Написать это можно куда угодно, например, перед подключением show_news.php. Без разницы.</p>
<p>Теперь нам доступны переменные $show_from и $show_to. $show_from говорит скрипту откуда показывать, $show_to говорит докуда. Указав эти переменные перед подключением show_news.php мы получим новости из нужного периода:</p>
<p class="code">$show_from = time; // данный год, месяц, день, минута и секунда, т.е. прямо сейчас <br>
 $show_to = (time - 60 * 60 * 24 * 11); // пояснения чуть ниже<br>
 include rootpath.'/show_news.php';</p>
<p>Функция time() всегда возвращает данное время, время на эту секунду. При каждом обновлении страницы time покажет настоящее время сервера. Для нашего примера (период в 11 дней) time для $show_from подходит отлично.</p>
<p>А вот $show_to имеет тонкость. Мы от настоящего времени (time) отимаем 11 дней:</p>
<p class="code">60 (секунд) * 60 (минут) = час<br>
 60 (секунд) * 60 (минут) * 24 (часа) = сутки<br>
 60 (секунд) * 60 (минут) * 24 (часа) * 11 (дней) = 11 суток</p>
<p>Как, я надеюсь, вы уже сообразили, наше главное число - 11. Именно оно в данном случае определяет за период скольки дней показывать новости.</p>
<p>P.S. Функцию <em>time()</em> использовать не нужно, используйте именно константу <em>time</em>.</p>
<h1><a name="Полезные ссылки"></a><small><a href="#top">[^]</a></small>&nbsp;Полезные ссылки</h1>
<ul>
 <li>На форуме "<a href="http://strawberry.goodgirl.ru/forum/viewforum.php?id=7">Стандартные и не совсем решения</a>" вы можете найти ещё разных хитростей.</li>
 <li>В теме F.A.Q. <a href="http://strawberry.goodgirl.ru/forum/viewtopic.php?id=1">также даются советы</a> по разным хитростям.</li>
</ul>
</body>
</html>