<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>Strawberry // What new</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link href="_tpl/style.css" rel="stylesheet" type="text/css" media="screen">
</head>

<body>

<h1>Оглавление</h1>
<ul>
<li><a href="#Информация">Информация</a></li>
<li><a href="#ToDo (нужно прикрутить)">ToDo (нужно прикрутить)</a></li>
<li><a href="#1.1.1">1.1.1</a></li>
<li><a href="#1.1">1.1</a></li>
<li><a href="#1.0.3">1.0.3</a></li>
<li><a href="#1.0.3 beta">1.0.3 beta</a></li>
<li><a href="#1.0.2">1.0.2</a></li>
<li><a href="#1.0.1">1.0.1</a></li>
<li><a href="#1.0">1.0</a></li>
<li><a href="#1.0 beta">1.0 beta</a></li>
<li><a href="#Пометка">Пометка</a></li>
<li><a href="#2.5.4">2.5.4</a></li>
<li><a href="#2.5.3">2.5.3</a></li>
<li><a href="#2.5.2">2.5.2</a></li>
<li><a href="#2.5.1">2.5.1</a></li>
<li><a href="#2.5">2.5</a></li>
<li><a href="#2.4.10">2.4.10</a></li>
<li><a href="#2.4.9">2.4.9</a></li>
<li><a href="#2.4.8">2.4.8</a></li>
<li><a href="#2.4.7">2.4.7</a></li>
<li><a href="#2.4.6">2.4.6</a></li>
<li><a href="#2.4.5">2.4.5</a></li>
<li><a href="#2.4.4">2.4.4</a></li>
<li><a href="#2.4.3">2.4.3</a></li>
<li><a href="#2.4.2">2.4.2</a></li>
<li><a href="#2.4.1">2.4.1</a></li>
<li><a href="#2.4">2.4</a></li>
<li><a href="#2.3.3">2.3.3</a></li>
<li><a href="#2.3.2">2.3.2</a></li>
<li><a href="#2.3.1">2.3.1</a></li>
<li><a href="#2.3">2.3</a></li>
<li><a href="#2.3 beta">2.3 beta</a></li>
<li><a href="#2.2">2.2</a></li>
<li><a href="#1.3.1">1.3.1</a></li>
<li><a href="#030 beta">030 beta</a></li>
<li><a href="#Пометка">Пометка</a></li>
<li><a href="#029">029</a></li>
<li><a href="#029 beta 6">029 beta 6</a></li>
<li><a href="#029 beta 5">029 beta 5</a></li>
<li><a href="#029 beta 4">029 beta 4</a></li>
<li><a href="#029 beta 3">029 beta 3</a></li>
<li><a href="#029 beta 1-2">029 beta 1-2</a></li>
<li><a href="#028">028</a></li>
<li><a href="#026">026</a></li>
</ul>
<h1><a name="Информация"></a><small><a href="#top">[^]</a></small>&nbsp;Информация</h1>
<ol>
<li>Если написано "читайте ридми" это значит "подробнее об этом Вы можете (читай - обязаны) прочесть в readme.html входящем в дистрибутив"</li>
<li>Если не написано - всё равно читайте</li>
<li>Версии с приписками альфа или бета использовать не стоит! Может что-нибудь накрыться чем-нибудь</li>
<li>При апгрейде, помимо папок inc и plugins, обновляйте и директорию skins. Не забывайте и про все файлы в главной директории скрипта, файлы в ней (head.php, show_news.php, xmlrpc.php и т.д.) меняются постоянно, если вы не можете изменить их вручную, т.е. довести до "кондиции" новой версии, то перезаписывайте их</li>
<li>Перед обновлением делайте бэкап базы</li>
</ol>
<h1><a name="ToDo (нужно прикрутить)"></a><small><a href="#top">[^]</a></small>&nbsp;ToDo (нужно прикрутить)</h1>
<ol>
<li>Загрузка картинок с http (Керуше)</li>
<li>Сделать подсчёт количества комментариев пользователя (?)</li>
<li>Иправить глюк со skip</li>
<li>Я так заигрался с УРЛами, что и не обратил внимания на то, сколько pgt делает функция построения УРЛов (straw_get_link()), надо что-то придумать. Кэш, конечно, спасёт, но всё равно неприятно</li>
<li>Возможность создавать поддомены, например, http://категория.example.com. По-мойму, достаточно задорно. Через mod_rewrite это работает с HTTP 1.1, что это и с чем едят я не знаю, надо разбираться</li>
</ol>
<!--start-->
<h1><a name="1.1.1"></a><small><a href="#top">[^]</a></small>&nbsp;1.1.1</h1>
<ul>
<li>Убиты баги со skip, page, cpage, ошибкой foreach, загрузкой аватаров и другие</li>
<li>Для шаблонов добавлена функция tpl(), для "безболезненного вызова функций плагинов. Первым аргументом tpl() должно идти название вызываемой функции, последующие аргументы это аргументы вызываемой функции</li>
<li>В дистрибутив добавлен плагин рейтинга новостей. Плагин этот не учитывает рейтиг плагина SwiZZeR`а написаного для CuteNews 2.5.4</li>
<li>В Drag'n'Drop Blocks добавлен "конструктор", который в дальнейшем планирую развивать и улучшать</li>
</ul>
<h1><a name="1.1"></a><small><a href="#top">[^]</a></small>&nbsp;1.1</h1>
<ol>
<li>Поменялась система шаблонов: php и массивы - лепота</li>
<li>Переделаны под новый набор функций плагины входящии в дистрибутив</li>
<li>Убиты некоторые мелкие баги</li>
<li>В группы пользователей в доступ добавлен пункт "разрешитиь оставлять комментарии" (при апгрейде всем группам по умолчанию такая функция будет доступна)</li>
<li>Исправлен баг с группами пользователей. Ошибся с типом поля</li>
<li>Переделан модуль шаблонов</li>
<li>Переделан модуль редактирования новостей. По сути, только код, но и на внешнем виде отразилось (в первую очередь тем, что всё можно сортировать)</li>
<li>Дополен модуль статистики, теперь около "Проверка системы" есть ссылка "вся" в скобочках. Если тыкнуть, то вылезят все ваши файлы и папки директории со скриптом и рядышком будут написаны их права (755, 777 и т.д.)</li>
<li>Изменилась функция шаблона для категории. Теперь шаблон меняется в общей ленте. Ну, только если посту присвоина одна категория, а не две, три</li>
<li>Изменил страницу примера, взял свой шаблон (как на этом сайте, цвет один - фиолетовый)</li>
<li>Исправил глюк с нумерацией комментариев</li>
<li>Пользователи, о чудное чудо, удаляются (<a href="http://strawberry.goodgirl.ru/other/zaebali-vy-menya.html">ссылка по теме</a>)</li>
<li>Вернул пароль к ЖЖ и его можно сохранять</li>
<li>Добавлен плагин Post Type, который позволяет выбрать тип поста (опрос, страница [отличается от новостей многоуровневостью], PHP)</li>
<li>В папку с шаблонами добавлена директория mail, там лежат шаблоны всех сообщений, которые могут понадобиться скрипту (входят лишь сообщения отправляемые через системный код, а не через плагины)</li>
<li>Немного дополнен ридми (текста там на 32 килобайта, блин), часть про rUFUs переписана полностью. Также дописана некоторая другая <a href="http://strawberry.goodgirl.ru/docs/">документация</a></li>
<li>В дистрибутив теперь будет входить и плагин Drag'n'Drop Blocks. В админке вы создаёте блоки, затем заходите на свою домашнюю страницу сайта (из настроек) и перетаскиваете блоки как душе угодно. Почти &quot;как душе годно&quot;, конечно :). Не забудьте в коде проставить: <em>&lt;!--block:NAME--&gt;</em>, где NAME это имя блока. Имена доступные любые, кроме blocks это зарезервиванное слово. Смотрите код example/index.php</li>
<li>Исправил ф-ию category_get_tree() путём внесения в таблицу categories поле level</li>
<li>Добавлено восстановление к резервному копированию. Старые бэкапы восстанавливаться сами не могут</li>
<li>Переделаны мультиязыки. Видимо, эта версия выйдет только на русском (чего я очень нехочу). Всё выводится через функцию t(), но и плагины с straw_lang() работать будут попрежнему</li>
<li>Попробовал переделать систему связаную с временем и его коррекцией. Не уверен в сто процентной работоспособности. Во-первых, не нужно вручную вводить разность времени (180, -120 и т.д.) для этого есть дроп-даун меню. Во-вторых, переход на летнее время происходит автоматически. В-третьих, смена часового пояса влияет на время новостей и комментариев (т.е. время при смене сдвигается)</li>
<li>Теперь $post работает и выше открытой новости. Если пост открыт, то $post везде доступна</li>
<li>Обновились группы пользователей. Теперь группам можно указывать доступные поля в добавить/редактировать. По умолчанию все поля доступны</li>
<li>Переделан движок поиска. Теперь с индексами и регистр букв не учитывается</li>
<li>Исправлен змечательный плагин Keywords (ключевые слова новостей) плюс немного доделан, теперь добавление кейвордов, а также их удаление происходит без перезагрузки</li>
<li>Кодировка не зависит от языка, она выбирается в админки отдельно</li>
<li>Для категорий добавлено поле "описание"</li>
<li>Добавился плагин банеров между постами</li>
<li>К аддону вывода юзеров добавилась "денежка", это типа рейтинга что ли. Можно давать денежку, можно отнимать её</li>
<li>Прибавился :) плагин Watermark благодаря ему можно ставить вотемарки сразу на группу картинок. Плагин основан на моде <a href="http://english.cutenews.ru/forum/improved-image-manager-t269.html">Improved image manager</a> от <a href="http://english.cutenews.ru/forum/profile.php?mode=viewprofile&u=2">FI-DD</a></li>
<li>Переделал плагин FI-DD Prev-next-links (ссылка на предыдущую и следующую новости) и засунул в дистрибутив</li>
<li>Плюс к категориям "защита" на чтение для групп, т.е. могут видеть только пользователи определённых групп</li>
<li>Закрепления новостей <i>только</i> для версии с MySQL</li>
<li>В urls.ini можно изменить УРЛ для переключения страниц новостей</li>
<li>Добавил count для запросов. В txtSQL версии от неё польы немного, зато в мускульной нагрузка уменьшится</li>
</ol>
<h1><a name="1.0.3"></a><small><a href="#top">[^]</a></small>&nbsp;1.0.3</h1>
<ul>
<li>Ловились и глушились мелкие баги</li>
</ul>
<h1><a name="1.0.3 beta"></a><small><a href="#top">[^]</a></small>&nbsp;1.0.3 beta</h1>
<ol>
<li>Иправлены глюки. Небольшая, зато многозначительная запись :)</li>
<li>Добавленны группы пользователей, штука с помощью, которой вы сможете создавать и редактировать группы</li>
<li>Два черезвычайно глупых изменения. Первое в шаблонах, бывший тег [catheader] теперь [category] (я долго кружил вокруг щаблонов, желаю их переделать да вот как бы удобнее пока не знаю, так вот, кружил и настока мне catheader надоел... вы бы знали)(если права выставленны верно, то при апгрейде скрипт сам всё заменит). Второе, чтобы облегчить себе и клавиатуре жизнь, теперь все yes и no $config это булин, т.е. 1 и 0 соответственно</li>
<li>Добавлена переменная $link. $link = 'home/test.php' укажет фаил (ту фигню, что в квадратных скобках) в urls.ini и будет ссылка куда хочешь. Удобная хреновина получилась. Её можно ставить и перед календарём и т.д. После вывода новостей одного инклуда, она обнуляется (становится home). Для нормальной работы, в шаблоне стоит изменить {link=home/post} на {link} (если этого апгрейд не сделает)</li>
</ol>
<h1><a name="1.0.2"></a><small><a href="#top">[^]</a></small>&nbsp;1.0.2</h1>
<ol>
<li>М-да, забыл добить баг с удалением постов. Сообщаю: теперь добил</li>
<li>Поправлены теги (avatar, if-user и т.д.) в комментариях</li>
<li>Добавлен плагин быстрых тегов, чтобы вытащить некоторых личностей из депрессии :)</li>
<li>Переделан бэкап, во-первых, теперь он как старый добрый модуль (именно модуль (inc/mod/backum.mdu), а не вшитый плагин, как rUFUs), во-вторых, разделён на бэкап БД и папки data, в-третих, для муслульной версии он сохраняет только таблицы Strawberry, в-четвёртых, какое-либо восстановление из админки пока отсутствует. Но восстановление через админку планируется, как планируется и автобэкап, настройки которого будут внесены в настройки системы. Кстати, для создания бэкапа требуется Zlib, она есть на 90% хостингов, но это так, на всякий случай. P.S. Мускульный бэкап я не умею делать, поэтому стырел уже готовый скрипт, проблема его в том, что работает он не самым желаемым образом, но я в процессе исправления</li>
<li>Из дистрибутива удалён английский язык, да простит меня Христиан, но с этим языком я вообще не дружу и возникают лишь проблемы</li>
<li>Важное исправление связанное с rUFUs`ом</li>
</ol>
<h1><a name="1.0.1"></a><small><a href="#top">[^]</a></small>&nbsp;1.0.1</h1>
<ol>
<li>Убиты мелкие баги поиска (теперь и фразы ищет), с удаления новостей, апгрейда (нельзя было переехать на Клубничку с CuteNews.RU мускульной), с УРЛами и т.д.</li>
<li>Посторался хоть кое-как дать описание почти всем функциям. Так что скоро выложу какую-никакую, а документацию и по функциям</li>
<li>Инсталяция (install.php) и апгрейд (upgrade.php) перемещены в папку inc. И удалять инсталятор теперь не нужно</li>
<li>Бекап теперь сохраняет все файлы на сервере (даже бекап папки data) и может отсылать фаил вам на e-mail. Я вот думаю как бы сделать процесс автоматизированным</li>
</ol>
<h1><a name="1.0"></a><small><a href="#top">[^]</a></small>&nbsp;1.0</h1>
<ol>
<li>В админку добавлен пункт позволяющей выбрать указывать ли e-mail обязательно или нет</li>
<li>Добавил кучу тегов для комментов: if-user, not-user, avatar, icq. Смторите опсание в настройки системы -> шаблоны -> комментарий</li>
<li>Исправлен небольшой косяк с mod_rewrite, правила несколько криво формировались</li>
<li>Починил кросспостинг, теперь пост после редактирования изменяется и в ЖЖ. Ещё при постинге через w.bloggar кросспостинг работает (но без вопросов, т.е. там нет галочки "опубликовать эту новость в ЖЖ")</li>
<li>Можно делать разные УРЛы, что-то как в старые времена, что-то по-новому. Всё будет работать и с включённым mod_rewrite (тем, что в админке :))</li>
<li>Испраалена глюка с категориями. $category = '3', пост с категориями 3,5,13 в ней не выводится. Всё из-за категории 13, точнее из-за 1 вначале</li>
</ol>
<h1><a name="1.0 beta"></a><small><a href="#top">[^]</a></small>&nbsp;1.0 beta</h1>
<ol>
<li>Изменилось имя CuteNews.RU на Strawberry. По CuteNews.RU это версия 2.6, для "Клубнички" - 1.0</li>
<li>Все переменные типа $config_что-то стали $config['что-то']. Старая переменная работать не будет, как и большенство плагинов (_не_ входящих в дистрибутив, конечно же)(в Application должно стоять Strawberry, подобное позволит избежать глупых вопросов и заставит переписать плагин под новые требования)</li>
<li>В дистрибутив добавлен плагин Eval позволяющий выполнять php в новостях и шаблонах</li>
<li>Деление комментариев на страницы (пока в несамом рабочем режиме :))</li>
<li>Удалено поле "Аватар" из добавления и редактирования новости, тег {avatar} теперь как и в комментарии заменяется на аватар пользоваталя</li>
<li>Немного изменён вид сохранённых шаблонов, на более адекватный ($template = 'содержание')</li>
<li>В админке - настройка системы rUFUs изменён на mod_rewrite. Типа включён он или нет. Соответственно $config['rufus'] теперь это $config['mod_rewrite']</li>
<li>УРЛы старого типа (?id={id} - читайте ридми) теперь работают нормально (насколько я смог протестировать), поэтому по умолчанию теперь используются они</li>
<li>Фильтр cutenews-options переименован в main-options</li>
<li>Поправлены некотороы функции, теперь количество запросов в БД при просмотре категорий увеличиватся не будет</li>
<li>Появился доп. массив $post. Он содержит в себе всю информацию открытой новости + $post['link'] это стандартная (home/post) ссылка на новость. Читайте в ридми</li>
<li>Подправил немного логику запросос: скобки добавил ('(id = 5', 'or', 'id = 6)'); limit для select (array(1) - от 0 до 1); изменил операторы ? и !?, для txtSQL это array_intersect() (или !array_intersect()), т.е. сравнение массивов, первый появляется из-за деления по запятым (,) второй по символу, название которого мне не известно (|). Рамки достаточно жёсткие, но для категорий и кейвордов это хорошая альтернатива прошлым запросам, которые вполне могли посадить MySQL на сервере (при условии большого числа народу (~>12 тысяч))). Для MySQL это regexp (и not regexp)</li>
<li>Удалён нах "глобальный кэш", обычный и так справляется замечательно, ибо я таки снезашёл до написания отдельного класса и на волне переделал кэш</li>
<li>Система комментариев несколько поменялась. Первым делом, добавлено поле homepage в таблицу комментариев. Это значит, что теперь поле e-mail обязательно и должно содержать e-mail, а не что-то ещё. А в homepage (тег {homepage}) должен быть линк сайта (это поле необязательное). Неавторизированный пользователь _должен_ зайти преже, чем будет добавлять комментарии, иначе не сможет использовать свои данные. Менять e-mail и логин пользователя системы в редактировании комментария нельзя, т.к. в базу заносится только логин, а всё потом берётся из настроек</li>
<li>Комментарии ещё добавлятся без перезагрузки страницы и стали древовидными (каждый может ответить на тот или иной комментарий). При удалении комментария удаляются и ответы на него</li>
<li>Убит глюк с количеством публикаций</li>
<li>Удалены теги и смайлики из добавление/редактирования поста. Чуть позже добавлю как плагин, ибо потому что</li>
<li>Немного изменил логику в управлении УРЛами, читайте ридми</li>
<li>Фильтр also-allow переименован в news-where, плюс для комментариев добавился comments-where</li>
<li>Чтобы как-то "ологичить" (от слова логика :)) отличия дополнений требующих инклуда, тперь они имеют префикс show_ (show_news.php, show_users.php, show_search.php). Дополнения, которые предпологают самостоятельную "жизнь" переименованы не были (rss.php, print.php и т.д.)</li>
</ol>
<h1><a name="Пометка"></a><small><a href="#top">[^]</a></small>&nbsp;Пометка</h1>
<p>Всё, что идёт ниже это CuteNews.RU, выше - уже Strawberry. Плагины несовместимы.</p><h1><a name="2.5.4"></a><small><a href="#top">[^]</a></small>&nbsp;2.5.4</h1>
<ul>
<li>Баг с УРЛами убит, я мудак</li>
</ul>
<h1><a name="2.5.3"></a><small><a href="#top">[^]</a></small>&nbsp;2.5.3</h1>
<ol>
<li>Убит глюк с сортировкой в $static</li>
<li>В дефолтный шаблон админки добавлен пункт "Очистить кэш". Это неправильно, но лучше так, чем плохо (иногда) удаляющийся кэш. Чистить кэш могут только админы. Кстати, если вы админ и хотите очистить кэш не заходя в админку просто допишите к адресной строке ?action=clearcache</li>
<li>Плагин keywords изменён: теперь можно давать кейвордам ссылки в управлении УРЛами (поле keywords (только для home), теги {keywords} или {keywords-id}). Теперь осталось разобраться со старой идеей "заметки по теме" и прикрутить менеджер кейвордом (их добавлять можно, а удалять - кукиш)</li>
</ol>
<h1><a name="2.5.2"></a><small><a href="#top">[^]</a></small>&nbsp;2.5.2</h1>
<ol>
<li>Убит глюк с полной новостью при отключённом руфусе</li>
<li>Поиск минимум по трём буквам</li>
</ol>
<h1><a name="2.5.1"></a><small><a href="#top">[^]</a></small>&nbsp;2.5.1</h1>
<ol>
<li>Поправлено превью</li>
<li>В функцию транслита для языка "Русский" входящий в дистрибутив, добавлена буква Э. Почему-то пропущеная ранее</li>
<li>Немного поправлен XMLRPC</li>
<li>Убит (надеюсь, навечно) баг с категориями. Спасибо Hellik`у</li>
<li>Убит баг с пропаданием списка новостей в редактировании постов</li>
</ol>
<h1><a name="2.5"></a><small><a href="#top">[^]</a></small>&nbsp;2.5</h1>
<ol>
<li>Поправлен модуль картинок, нефиг ему заливать что попало</li>
<li>При удалении категории все её "дети" так же удаляются</li>
<li>Шаблоны перенесены в папку data/tpl при апгрейде скрипт сам попробует создать папку, проставить ей права и перенести туда все шаблоны, но лучше это сделать вручную</li>
<li>В дистрибутив включён плагин мета тегов, по умолчанию дезактивирован, если выключено кэширование плагин очень много pgt жрёт (из-за плагинских доп. полей, какие-то они тормознутые)</li>
<li>Поправлен апгрейд, не будет теперь проблем с urls.ini и апгрейд теперь не нужно запускать вручную, скрипт сам всё сделает</li>
<li>Переезды (с txtSQL на MySQL, с 02x на 03x) перемещены в папку convert</li>
<li>Обычный кэш по умолчанию включён</li>
<li>Исправлен баг премодерации новостей</li>
<li>Исправлен баг связаный с переключением страниц новости</li>
<li>Исправлен баг с несколькими подключениями, к сожалению, во всём был виноват кэш txtSQL, я боюсь, без кэширования у этой БД появилось больше шансов :(</li>
<li>В дистрибутив добавлен плагин "Кейворды", это не мета кейворды, а система классификации новостей, посту можно присваивать не только категории, но и кейворды. Ставятся они в общую БД, поэтому каких-то увеличний pgt быть не должно</li>
<li>Теперь снова (возможность была в 029, а в 030 я удалил) можно дополнять .htaccess</li>
</ol>
<h1><a name="2.4.10"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.10</h1>
<ol>
<li>Это секюрити апгрейд!!! show_news.php из этого дистрибутива нужно взять обязательно!</li>
<li>Немного поправлен календарь, иногда активный день не понимался</li>
<li>Исправлена херня с категориями-"родителями"</li>
<li>Поправлен cn_title()</li>
</ol>
<h1><a name="2.4.9"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.9</h1>
<ol>
<li>Введён "глобальный кэш" читайте в ридми</li>
<li>В базувую сборку включён мод remote headlines</li>
<li>Подправлен txtSQL</li>
<li>В поиск введён поиск по категориям и дате</li>
<li>Исправлена фигня с переключателями страниц</li>
<li>Исправил TrackBack</li>
<li>Поправлен бекап для папки data (был глюк с субдиректориями)</li>
<li>Исправлен глюк с "невидимостью" новостей из определённых категорий</li>
<li>Убита фигня c функцией category_get_children(), раньше она делала кучу ненужных запросов к БД</li>
<li>Мыло человека оставившего комментарий теперь прячется от роботов через яву</li>
</ol>
<h1><a name="2.4.8"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.8</h1>
<ul>
<li>Убиты мелкие баги с кэшем, категориями, УРЛами</li>
</ul>
<h1><a name="2.4.7"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.7</h1>
<ol>
<li>Это секюрити апгрейд!!! search.php и head.php из этого дистрибутива нужно взять обязательно!!!</li>
<li>Поправлен запрос (типа урл?some=some) попадющий в УРЛ</li>
<li>Поправлен XMLRPC, когда постишь через него, то "УРЛ" не прописывался и новость была не найдена</li>
</ol>
<h1><a name="2.4.6"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.6</h1>
<ol>
<li>Исправлен переезд на с txtSQL на MySQL. Теперь 100% рабочий</li>
<li>Минус два запроса к БД при включённом кэше</li>
</ol>
<h1><a name="2.4.5"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.5</h1>
<ol>
<li>Попытка побороть "слетание" текстовой базы. Надеюсь, получилось</li>
<li>Поправлен бекап (восстановление БД из него) и несколько других не смертельных глюков</li>
</ol>
<h1><a name="2.4.4"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.4</h1>
<ol>
<li>Поправлен глюк с премодерацией. Раньше он как бы не сохранялся, в любом случае было "Да"</li>
<li>В скин (админки, естественно :)) default к меню добавлен плюсик рядом с "Настройки", если по нему кликнуть вылезет меню настроек</li>
<li>Поправлено формирование правила для категорий, теперь можно смело использовать категории без префикса (как у нас на сайте)</li>
<li>Поиск исправлен (да, и я ещё в прошлой версии добавил подсветку найденого через CSS класс hilite, забыл написать)</li>
<li>Убиты маленькие недоделы с предпросмотром, ответом админа (при редактировании там были видны br`ы), и статистикой о БД</li>
<li>Исправлен глюк с id новостей, когда открывалась полная новость содержащая цифру эта цифра воспринималась как id, не всегда, но бывало. Теперь всё хорошо</li>
<li>Добавлена возможность бекапить базу MySQL, читайте ридми</li>
</ol>
<h1><a name="2.4.3"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.3</h1>
<ol>
<li>Исправлена проблема с отображением аватара пользователя в комментариях</li>
<li>Поправлен переезд на мускул</li>
<li>Поправлен переезд с более ранних версий</li>
<li>Исправлено формирование .htaccess</li>
</ol>
<h1><a name="2.4.2"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.2</h1>
<ol>
<li>Добавлен переезд с txtSQL (текcтовой версии) на MySQL. Читайте ридми</li>
<li>Подправлен класс MySQL. Теперь поиск работает хорошо</li>
<li>Убит баг с загрузкой аватаров</li>
<li>Поправлено формирование УРЛов, читайте в ридми "rUFUs / Управление УРЛами", смотрите там же примеры</li>
</ol>
<h1><a name="2.4.1"></a><small><a href="#top">[^]</a></small>&nbsp;2.4.1</h1>
<ol>
<li>Исправлен баг связаный с именами авторов новостей</li>
<li>Апгрейд с 02x теперь переносит и количество просмотров</li>
<li>Форма добавления переехала в inc/show.commentform.php и появился новый фильтр news-allow-commentform</li>
<li>Количество обращений к базе снижено до 6 запросов (в базовой сборке, сиречь, без каких-либо плагинов) при любом кол-ве новостей</li>
<li>Теперь функция category_get_tree() выводит префикс как надо (ровно +1 идёт, а не фиг знает сколько)</li>
<li>Исправлена проблема с премодерацией</li>
<li>Исправлен апгрейд с версии 2.3</li>
</ol>
<h1><a name="2.4"></a><small><a href="#top">[^]</a></small>&nbsp;2.4</h1>
<ol>
<li>Частично вернул УРЛы вида ?id=ID и т.д. "Частично" потому что, если новость разбита на страницы сылки на них будут ?id=ID?page=PAGE. Такие дела. Читайте ридми</li>
<li>Исправлена ошибка с директориями пользователей для картинок</li>
<li>Исправлена проблема с добавлением комментария после введения пароля</li>
<li>Добавлена функция для категорий: category_get_id(). Она получает ID категории из её УРЛа (типа category_get_id($category) даст 5, где $category это УРЛ типа "родитель/наша_категория") и из названия (category_get_id('Наша категория') даст 5, то есть её ID). Более подробно о функциях категорий смотрите в ридми!</li>
<li>В "управлении УРЛами" plain переименован в home. Во время апгрейда скрипт постарается подправить шаблоны и urls.ini сам</li>
<li>У меня кончились сигареты, чиорт</li>
<li>Кэш по умолчанию выключен</li>
<li>Config из "управление УРЛами" теперь в в "настройках системы" (закладка "система")</li>
<li>Добавлена возможность разных директорий и файлов, в которых будет открываться новость/категория/etc. при включённом ЧПУ. Читайте ридми</li>
<li>Теперь при редактировании новости автор не изменяется</li>
<li>Всё немного подправлено для нормальной работы с php 5.0.5</li>
</ol>
<h1><a name="2.3.3"></a><small><a href="#top">[^]</a></small>&nbsp;2.3.3</h1>
<ol>
<li>Поправлен переезд с версий 02x</li>
<li>Языки: всё из папки upgrade перенесено в фаил upgrade.ini</li>
<li>Поправлен модуль "Поиск и Замена"</li>
<li>Новый пункт в настройках системы, вкладке "новости" - "Определённые категории для журналистов". Теперь можно указывать разрешать все категории или нет. Если разрешены только определённые, то для каждого журналиста их нужно установить (для каждого журналиста отдельно)</li>
<li>"закладки" в настройках системы снова работают как надо и, как и раньше, только в ИЕ и Опере</li>
<li>Немного изменился мод картинок. Во-первых, теперь всё немного симпатявее. Во-вторых, деление на страницы (21 картинка на одной странице). В-третих, картинки сортируются по дате заливки. Последнии залитые картинки теперь всегда на первой странице (если вы не залили больше 21 картинки :))</li>
<li>Даты снова по-русски идут. Как я бы не хотел делать даты через strftime(), а не через date(), но попрежнему, после опыта с календарём, от слова "локаль" муражки по жопе бегают</li>
</ol>
<h1><a name="2.3.2"></a><small><a href="#top">[^]</a></small>&nbsp;2.3.2</h1>
<ol>
<li>Сделал более приличную имитацию join для txtSQL</li>
<li>Убит баг с многократным, да, опять, подключением (была проблема с txtSQL)</li>
<li>В последний раз, честно-честно, изменил апгрейд версий. Читайте ридми. Всё стало вроще. Апгрейд в один клик</li>
<li>И снова баги-баги-баги. Я начинаю себя раздражать</li>
</ol>
<h1><a name="2.3.1"></a><small><a href="#top">[^]</a></small>&nbsp;2.3.1</h1>
<ul>
<li>Исправлен глюк с УРЛами, если ЧПУ = "yes" и "домашняя страница сайта" находится в директории выше (относительно скрипта, конечно же)</li>
</ul>
<h1><a name="2.3"></a><small><a href="#top">[^]</a></small>&nbsp;2.3</h1>
<ol>
<li>В images.ini добавлена: remove = "[удалить]"</li>
<li>Для каждой категории можно выбрать свой шаблон. Это системная функция. Есть ещё и плагин позволяющий присваивать свой шаблон для каждой новости</li>
<li>Уменьшено кол-во запросов к базе. В дальнейшем будет снижено ещё больше</li>
</ol>
<h1><a name="2.3 beta"></a><small><a href="#top">[^]</a></small>&nbsp;2.3 beta</h1>
<ol>
<li>Добавлена функция выбора шаблона для категории</li>
<li>Выбор БД. Версия с MySQL работает в тестовом режиме. Из замеченых глюков: перенос базы с версий 02x криво работает. Из несделанного, но нужного: миграция с одной БД на другую.</li>
<li>Исправлен баг с пассвордом при добавлении комментария</li>
<li>В rufus.ini добавлен: rufus = "не работает, rufus не yes"</li>
<li>Изменён ЧПУ. Настройка стала проще за счёт отказа от УРЛов вида ?get=some&get22=some2. Они, конечно, работать будут, но уже не в полной мере и с возможными неадекватными последствиями. Читайте ридми и смотите urls.ini в папке data или в админке -> управление УРами</li>
</ol>
<h1><a name="2.2"></a><small><a href="#top">[^]</a></small>&nbsp;2.2</h1>
<ol>
<li>Изменён апгрейд версий, читайте в ридми</li>
<li>В "Приблуды" добавлена cn_title()</li>
<li>Определённые категории для определённого журналиста</li>
<li>Премодерация, по умолчанию выключена. Включить в админке -> настройки системы -> закладка "Новости". Все посты добавленные или отредактированные журналистами не видят пользователи и комментаторы, но видят журналисты, редакторы и админы. Короче, не особо продумано, но я не очень представляю себе это дело</li>
<li>Xfields переделан под плагин</li>
<li>Переписан модуль картинок</li>
</ol>
<h1><a name="1.3.1"></a><small><a href="#top">[^]</a></small>&nbsp;1.3.1</h1>
<ol>
<li>Глюк с id категорий покоцан. рррррр - вот с какой яростью, ага</li>
<li>Проблема с $number убита-та-та</li>
<li>Чередование фона для постов через CSS cn_news_even и cn_news_odd</li>
</ol>
<h1><a name="030 beta"></a><small><a href="#top">[^]</a></small>&nbsp;030 beta</h1>
<ol>
<li>Переход на txtSQL</li>
<li>Маленький "ребрендинг" :)</li>
<li>Вывод за год ($year), месяц ($month), день ($day). Ессно, может работать вкупе с $category</li>
<li>Сортировка по одному из признаков. $sort = array(name, [ASC|DESC]) (или $sort[0] = 'name'; $sort[1] = 'ASC|DESC'), где name это date, author, title, short (кол-во знаков в короткой новости), full (кол-во знаков в полной новости), avatar, category, url, id, views (счётчик просмотров) или comments (счётчик комментариев), ASC или DESC - способы сортировки. ASC (ASCENDING) сортирует по возрастанию, DESC (DESCENDING) - по убыванию. Например, $sort = array('comments', 'DESC') - будет сортировать новости в порядке "у кого больше комментариев"</li>
<li>Чуток переписан вывод новостей, выросло, точнее, понизилось pgt (время генерации страницы)</li>
<li>Вывод для определённого автора: $user = 'автор' или $author = 'автор'</li>
<li>При загрузки картинки с русским названием это самое название перекодируется в транслит</li>
<li>$config_chmod (отвечающая за права на чтение/запись, в functions.inc.php) теперь не переменная, а константа chmod (регистр не важен)</li>
<li>Разрезан shows.inc.php, теперь он show.inc.php. За вывод новостей отвечает show.news.php, комментариев - show.comments.php, а за добавление комментария фаил show.addcomment.php</li>
<li>При просмотре категории-"родителя" выводятся и её субкатегории</li>
<li>Добавил "разрезатель" новости на страницы.- этим, ага, оригинальничить не стал</li>
<li>Изменён вид добавления и редактирования новостей. Терь всё через fieldset`ы и CSS</li>
<li>При добавлении/редактировании постов и в управлении категориями сделал нормальный, древовидный вывод категорий</li>
<li>Нормальное кеширование</li>
<li>Автопростановка УРЛа к аватару</li>
<li>Вроде как, разобрался с правами и тегом if-logged. Комментатор теперь может править свои каляки, при условии, что админ разрешил правку комментаторам.</li>
<li>Трекбек</li>
<li>"убрать запись куки для папки, сделать для всего домена, может быть, спасут сессии" - это было в 2do. Сессии спасли</li>
<li>ЧПУ переделал, теперь это управление УРЛами. От старого rUFUs`а ничего не осталось</li>
<li>Перепесаны полностью под txtSQL все модули categories.mdu, main.mdu, snr.mdu, options.mdu, massactions.mdu, addnews.mdu, editnews.mdu, ipban.mdu, editcomments.mdu, editusers.mdu)</li>
<li>Начат ридми</li>
<li>Решина проблема с хостами с safe mode методом создавания руками</li>
<li>Сделал переключение языков для админки (модуль картинок переписан не будет, по причине его дебильности. К релизу он будет заменён сторонним скриптом. XFields я боюсь, но к релизу перепишу)</li>
<li>В настройках УРЛов тег {cat} заменён на {сategory}, а {сategory} на {categories}</li>
<li>Исправлена $sort, теперь сортирует как надо (все посты, а не только выводимые)</li>
<li>Убил вернувшийся из зада глюк с новостями со $static = true, которые находились перед основным инклудом (это те (гы), что без $static)</li>
<li>Xfields.mdu так и не посадил на мультиязыки. Лень, аж пиздец</li>
<li>$static по причине херовой работы теперь массив из переменных. Новости со $static['переменная'] работают как должны, просто $переменная работать не будет</li>
</ol>
<h1><a name="Пометка"></a><small><a href="#top">[^]</a></small>&nbsp;Пометка</h1>
<p>Всё, что идёт ниже это 020 series :), выше - 030. Плагины несовместимы.</p><h1><a name="029"></a><small><a href="#top">[^]</a></small>&nbsp;029</h1>
<ol>
<li>Исправлены управления ЧПУ. Теперь вам нужно лишь нажать на кнопку "Генерировать". И, вуаля, примеры. Не нужно заходить в шаблоны и т.д. Кеш чиститься чаще: при измненении шаблонов, добавлении категории (реализовано только с субкатегориями, а не обычными, стандартными), редактировании поста, etc. Ваши манипуляции сведены к минимуму. + в "Настройках ЧПУ" появилась ссылка на хелп в системе</li>
<li>Поправлен вид субкатегорий в админке</li>
<li>Если новость открыта (full story), то её не видно в списках других выводов</li>
<li>Убит плагин "rUFUs формат". Эта возможность вновь часть самого ЧПУ</li>
<li>В кросспостинг и шаблоны ЧПУ добавлена stripslashes(). Теперь не будет проблем с кавычками</li>
</ol>
<h1><a name="029 beta 6"></a><small><a href="#top">[^]</a></small>&nbsp;029 beta 6</h1>
<ol>
<li>Добавлен хак zipbackup: вводите логин и пароль и жмёте "Сохранить". Вся папка data будет зазипована и дана возможность для скачивания. Ничего в этом мире не совершенно, всё иной раз слетает, на. Президенты тоже слетают, на. Жизнь такая, на. Кстати, на, чтобы скачивать data зазипованную нужно ввести логин, пароль и обладать нужными правами (см. фаил zipbackup.php, 4 строка; там есть комментарий)</li>
<li>Добавлен плагин для слежения за новыми комментариями самими же комментаторами. Отписатца незя :)</li>
<li>В добавление и редактирование новости добавлена ф-ия предпросмотра аватара</li>
<li>Изменена inserttext() для вставки bbCode и смайлов. Работает в Firefox, в IE и немного (теги не окружают текст) в Opera</li>
<li>Поправлен поиск для ЧПУ (включая плагин "rUFUs формат")</li>
<li>Для юзерей добавлен RSS feed (без ЧПУ выглядит как rss.php?show_user=lexa, а с - /users/lexa{расширение_xml_файлов})</li>
<li>Поправил некоторые плагины, в том числе у ЧПУ генерацию .htaccess, а из хаков - show_users.php (перед инклудом можно использовать $bgcolor для смены цвета бордюров и задника; или просто поковырять этот фаил) и rss.php</li>
<li>Макрос {rsslink} немного изменён, теперь ссылка начинается со слеша. Поправьте шаблоны, если пользовали этот макрос</li>
<li>Поставил библиотеку XML-RPC 2.2.1 заместо 2.5f, ибо последняя глючила. Поэтому кросспостинг (см. ниже) и XML-RPC должны норально работать</li>
<li>Исправил все глюки кросспостинга, людей у которых нет ЧПУ, надеюсь, немного порадует тот факт, что и без ЧПУ кросспостить можно и оставлять ссылку на оргинал</li>
<li>Добавил пару фильтров (это для плагинов) к ЧПУ, а в functions.inc.php ф-ию _url(string array) для вычисления УРЛа. Она очень помогла в "rUFUs закладки", поиске и кросспостинге</li>
<li>Изменены CSS для календаря. Примеры смотрите в ридми</li>
<li>Название действия для плагина show-news-php заменено на head. Что более логично: раньше (при жизни Колобка (hint: сказочный персоонаж из теста наскребённого по сусекам, а не ваш покойных сосед-панк-нароман-забулдыга с таким ником) это действие было в show_news.php, теперь же вызывается в head.php)</li>
<li>Плагин субдиректорий прикрутил. Желание выходить за рамки плагина не было, даже наобарот - тяга оставить это только плагином, поэтому не изменена система управления категориями, а в "админке -&gt; субкатегории" нужно определять "главенствующую" категорию. Теоретически, "субкатегорность" бесконечная. Для работы субкатегорий вместо rufus_category() нужно использовать rufus_subcategory(). rufus_subcategory() от rufus_category() отличается только тем, что когда вы задаёте параметры (не вида списка, например drop-down; см. ридми) он возвращает не противоположность (id категрии или её "кличку"), а УРЛ к ней</li>
<li>Плагин популярных (по кол-ву прочтений) постов. rufus_popular(N), где N кол-во выводимых зголовков. Если N не проставлено, то выводится 10</li>
<li>Поправлен вид админки для Firefox</li>
<li>Для комментариев добавлены макросы {avatar} и {title}. Первое - аватар пользователя, второе - заголовок новости</li>
<li>Добавил фильтров для помощи и редактировния шаблонов. Теперь в плагинах можно указывать макросы и ссылку на помощь. Очень удобно. Аджею вообще огромное спасибо</li>
<li>Переменная $config_chmod переползла в inc/functions.inc.php. Работает на 100%. Напомню, она содержит в себе права для чтения/записи. CHMOD по умолчанию 0777</li>
<li>Убита какашка с ?mod=editnews&action=editnews&id=[id]&source=alert(document.cookie);</li>
<li>Поправил кеш, при редактировании поста нужный кеш тихонечко стирается</li>
<li>Теперь, если у вас нет mod_rewrite на сервере, но хотца ЧПУ и все его приблуды, откройте в head.php и замените в define('mod_rewrite', true) true на false. Теперь ЧПУ и без mod_rewrite, хм, подрабатывают. Всё дело (в волшебных пузырьках) просходит через запрос (напишите где-нибудь в php файле "echo $_SERVER['QUERY_STRING'];" без кавычек), т.е. в отличии от обычных ЧПУ к этим добавляется в начало знак вопроса, а потом в head.php всё обрабатывается под нужды</li>
</ol>
<h1><a name="029 beta 5"></a><small><a href="#top">[^]</a></small>&nbsp;029 beta 5</h1>
<ol>
<li>Приблуды подключены к шаблонам</li>
<li>Добавлена опция редактирования шаблонов для приблуд</li>
<li>Прописаны макросы и всё посажено на плагины, фильтр «rufus-plugin-template». Пример смотрите в плагине «Закладки» (add-to-bookmark.php)</li>
<li>Удален префикс $_URL['rufus'] при генерации .htaccess из категорий</li>
<li>Добавлена $unic_cache_id при кешировании и уникальности того или иного кеша для подключения</li>
<li>Удалена $from для ЧПУ. $start_from потому что работает намана :)</li>
<li>Убил lt;body onLoad=alert('text')> методом вставления кола в жопу, т.е. через элементарный htmlspecialchars(). Имя и адрес (мыло/линк) автора не должно содержать «плохих» символов. Это, в конце концов, имя, а не говна кусок</li>
<li>Глюк со «смещением» полей комментариев так же жестоко убит, заобно подправлен сам отсыл ответов и т.д.</li>
<li>В index.php скрипта добавлена переменная $config_chmod несущая в себе CHMOD для автопростановки (полезно) чмодов. По умолчанию идёт 0777, если будете менять - не забудьте ноль в начале проставить (напр.: 0755, а не 755)</li>
<li>Отвязал .htaccess ЧПУшный от главной директории. Не забывайте проставлять «УРЛ» в «Общих настройках ЧПУ» как имя папки (напр.: dir или dir1/dir2), где лежит фаил с выводом новостей</li>
<li>В ЧПУ добавлены опции: 1) место куды генерировать .htaccess; 2) индекс директории (фаил, который будет отображать новости с ЧПУ)</li>
<li>Дополнена опция "Дополнения .htaccess ", теперь там прописаны все доступные макросы</li>
</ol>
<h1><a name="029 beta 4"></a><small><a href="#top">[^]</a></small>&nbsp;029 beta 4</h1>
<ul>
<li>Лог не вёлся</li>
</ul>
<h1><a name="029 beta 3"></a><small><a href="#top">[^]</a></small>&nbsp;029 beta 3</h1>
<ul>
<li>Лог не вёлся</li>
</ul>
<h1><a name="029 beta 1-2"></a><small><a href="#top">[^]</a></small>&nbsp;029 beta 1-2</h1>
<ol>
<li>Добавлена возможность поиска по категориям (search.php)</li>
<li>Включена подсветка найденных слов (изменение через CSS-стиль .hilite) и вывод куска текста при поиске</li>
<li>Изменен модуль настроек системы: все настройки рассортированы по категориям</li>
<li>Опциональный выбор создания отдельных папок для каждого пользователя при загрузке картинок</li>
<li>Добавлен вывод новостей определенного пользователя (переменная $show_user = «USER_NAME»;)</li>
<li>Сортировка и массовое удаление пользователей в модуле управления ими</li>
<li>«уровни доступа» переименованы в «статусы»</li>
<li>Добавлен модули автоматической регистрации пользователей и просмотра списка зарегистрированных пользователей и их профилей (register.php и show_users.php)</li>
<li>Расширенный профиль пользователей</li>
<li>Возможность загрузки аватар пользователями</li>
<li>Ввод дополнительных данных: сайт, ICQ, интересы</li>
<li>Плагин кросспостинга в ЖЖ</li>
<li>Для новотей введены теги форматирования lj-cut, lj user, lj comm и lj synd</li>
<li>Добавлен плагин ЧПУ</li>
<li>Также выбор формата УРЛа (год/месяц/день/пост.хтм или cat/категория/пост.хтм)</li>
<li>Добавление в закладки</li>
<li>Календарь</li>
<li>Вывод по категориям</li>
<li>RSS для каждой категории в отдельности (по адресу cat/категория/rss.xml, если плагин ЧПУ не включён, то path/to/rss.php?category=ID, где ID это id категории)</li>
<li>Добавлен плагин мультикатегорий. Теперь Вы можете выбирать для новости не одну, а несколько (в пределах двадцати) категорий</li>
<li>Добавлена библиотека XML-RPC (для кросспостинга и постинга довостей через программу)</li>
</ol>
<h1><a name="028"></a><small><a href="#top">[^]</a></small>&nbsp;028</h1>
<ol>
<li>По умолчанию убран плагин ЧПУ. Он будет доведен до совершенства и выкинут отдельно, именно как плагин.</li>
<li>Устранена ошибка в модуле управления картинками. Для админа не создавалась папка и вылетала ошибка, теперь все OK!</li>
<li>Устраненая ошибка при выводе bb-кодов</li>
<li>Изменен менеджер HTML-тэгов в админке. Теперь работает во всех современных браузерах (хотя и уступает старому по функциональности!) и включается одной функцией</li>
<li>Убраны мелкие баги в поисковике</li>
<li>Изменено деление страниц по категориям. Теперь это делается одной функцией, а список выводится на всех страницах сайта, как разделы</li>
<li>Исправлена ошибка при редактировании новостей, при которой нельзя было менять дополнительные поля</li>
</ol>
<h1><a name="026"></a><small><a href="#top">[^]</a></small>&nbsp;026</h1>
<ol>
<li>Добавлен менеджер плагинов и набор включенных плагинов, о каждом из которых можно почитать на сайте скрипта</li>
<li>Вывод ссылок на страницах новостей стал сокращенным, если страниц больше 10-ти</li>
<li>Включена проверка на наличие установочного файла, проверка версии php-интерпретатора и свободного места на сервере</li>
<li>Теперь русифицированы все даты во всех модулях скрипта. Кроме поля для изменения даты новости (там нужно вводить дату на английском!)</li>
<li>Изменена страница для печати. Теперь она использует шаблоны</li>
<li>Изменена RSS-лента. Теперь она также использует шаблоны</li>
<li>Обновлен модуль "Дополнительные поля", который стал еще более функциональным</li>
<li>Использование кириллических символов в полях</li>
<li>Изменение очередности полей</li>
<li>Три вида типа поля</li>
<li>Выбор категории для каждого поля</li>
<li>Одна строка</li>
<li>Несколько строк</li>
<li>Выпадающее меню</li>
<li>Включена корректная обработка сохраненных данных для комментариев в Cookie</li>
<li>Добавлена функция группового вывода даты на несколько новостей за один день</li>
</ol>
</body>
</html>